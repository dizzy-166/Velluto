{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="account-container">
    <!-- –õ–µ–≤—ã–π —Å–∞–π–¥–±–∞—Ä (–ø—Ä–æ—Ñ–∏–ª—å) -->
    <aside class="profile-sidebar">
        <div class="user-info">
            <div class="avatar">{{ user.get_initials }}</div>
            <h1 class="user-name">{{ user.get_full_name|default:user.username }}</h1>
            <p class="user-email">{{ user.email }}</p>
        </div>

        <div class="profile-menu">
            <div class="menu-item active" data-section="orders">
                <i>üì¶</i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
            </div>
            <div class="menu-item" data-section="personal">
                <i>üë§</i> –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            </div>
        </div>

        <div class="logout-btn-container">
            <a href="{% url 'home' %}" class="action-btn home-btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="{% url 'logout' %}" class="action-btn logout-btn">–í—ã–π—Ç–∏</a>
        </div>
    </aside>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
        <div class="content-section active" id="orders-section">
            <h2 class="section-title">–ú–æ–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h2>
            <table class="orders-table">
                {% for order in orders %}
                <tr>
                    <td>‚Ññ {{ order.id }}</td>
                    <td>{{ order.product.name }}</td>
                    <td>{{ order.total_price }} ‚ÇΩ</td>
                    <td><span class="order-status status-{{ order.status }}">{{ order.get_status_display }}</span></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <div class="content-section" id="personal-section">
            <h2 class="section-title">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
            <form class="personal-data-form" method="post" action="{% url 'update_profile' %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="fullname">–§–ò–û</label>
                    <input type="text" id="fullname" name="fullname" value="{{ user.get_full_name }}">
                </div>

                <div class="form-group">
                    <label for="email">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</label>
                    <input type="email" id="email" name="email" value="{{ user.email }}">
                </div>

                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" id="phone" name="phone" value="{{ user.profile.phone }}">
                </div>

                <div class="form-group">
                    <label for="address">–ê–¥—Ä–µ—Å</label>
                    <input type="text" id="address" name="address" value="{{ user.profile.address }}">
                </div>

                <div class="registration-date">
                    <strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user.date_joined|date:"d E Y" }}
                </div>

                <button type="submit" class="save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </form>
        </div>
    </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const menuItems = document.querySelectorAll('.menu-item');
    const contentSections = document.querySelectorAll('.content-section');

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏
    menuItems.forEach(item => {
        item.addEventListener('click', function() {
            menuItems.forEach(i => i.classList.remove('active'));
            this.classList.add('active');

            contentSections.forEach(section => {
                section.classList.remove('active');
            });

            const sectionId = this.getAttribute('data-section') + '-section';
            document.getElementById(sectionId).classList.add('active');
        });
    });
});
</script>
{% endblock %}